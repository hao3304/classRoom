query GetAnnals {
  annals {
    id
    name
    level
    position
    addr
    status
    created
    related_plan {
      id
      name
    }
  }
}

query GetAnnal($id: String) {
  annal(id: $id) {
    id
    level
    position
    name
    addr
    status
    created
    related_plan {
      id
      name
    }

    related_event {
      id
    }

    related_commander {
      id
      name
    }

    logs {
      id
      type
      log
    }

    commands {
      action
      desc
    }

    orgs {
      id
      name
      duty
      members {
        id
        leader
        user {
          id
          name
          mobile
          job
          roles {
            id
            name
          }
          position {
            lng
            lat
            time
          }
        }
      }
    }

    stages {
      id
      stage
      actions {
        id
        action
        desc
        org
        organize {
          id
          name
          duty
        }
        commands {
          id
          desc
          atime
          action
          completed
          ctime
          remark
          related_cuser {
            id
            name
          }
          related_commander {
            id
            name
          }
        }
      }
    }

    materials {
      id
      name
      amount
      inplace
    }

    equipments {
      id
      name
      amount
      inplace
    }
  }
}

mutation StartAnnal(
  $plan: String!
  $level: String
  $name: String!
  $commander: String
  $position: String!
  $addr: String!
  $event: String
  $orgs: [IBizAnnalOrg!]
  $stages: [IBizAnnalStage!]
  $materials: [IBizAnnalMaterial!]
  $equipments: [IBizAnnalEquipment!]
) {
  biz_annal_start(
    input: {
      plan: $plan
      name: $name
      level: $level
      commander: $commander
      position: $position
      addr: $addr
      event: $event
      orgs: $orgs
      stages: $stages
      materials: $materials
      equipments: $equipments
    }
  ) {
    id
  }
}

mutation AnnalUserAdd($org: String!, $user: IBizAnnalUser) {
  biz_annal_user_add(org: $org, input: $user) {
    id
  }
}

mutation AnnalUserDel($id: String!) {
  biz_annal_user_delete(id: $id)
}

mutation AnnalMaterialAdd($annal: String!, $input: IBizAnnalMaterial) {
  biz_annal_material_add(annal: $annal, input: $input) {
    id
  }
}

mutation AnnalMaterialInplace($id: String!, $inplace: Int, $amount: String) {
  biz_annal_material_inplace(id: $id, inplace: $inplace, amount: $amount)
}

mutation AnnalMaterialDelete($id: String!) {
  biz_annal_material_delete(id: $id)
}

mutation AnnalEquipmentAdd($annal: String!, $input: IBizAnnalEquipment) {
  biz_annal_equipment_add(annal: $annal, input: $input) {
    id
  }
}

mutation AnnalEquipmentInplace($id: String!, $inplace: Int, $amount: String) {
  biz_annal_equipment_inplace(id: $id, inplace: $inplace, amount: $amount)
}

mutation AnnalEquipmentDelete($id: String!) {
  biz_annal_equipment_delete(id: $id)
}

mutation AnnalTerminate($annal: String!) {
  biz_annal_terminate(annal: $annal)
}

mutation AnnalCommand(
  $commander: String
  $action: String
  $desc: String
  $cuid: String
) {
  biz_annal_command(
    input: { commander: $commander, action: $action, desc: $desc, cuid: $cuid }
  ) {
    desc
  }
}

mutation CommandCompleted($id: String!) {
  biz_annal_command_completed(id: $id)
}
